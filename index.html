<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página Principal de Ventas</title>
    <!-- Incluye Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define una fuente bonita para el título */
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,700&family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif; /* Aplica la fuente Inter al cuerpo para el texto general */
            background-color: #f8f8f8; /* Un fondo muy claro para un look limpio */
            display: flex;
            flex-direction: column; /* Organiza los elementos en columna */
            align-items: center; /* Centra el contenido horizontalmente */
            min-height: 100vh; /* Asegura que ocupe al menos toda la altura de la ventana */
        }
        /* Estilo específico para el título 'PROJECT MOM' con la nueva tipografía itálica */
        .title-font {
            font-family: 'Playfair Display', serif;
            font-style: italic;
        }
        /* Estilos para el carrusel principal */
        #productCarousel {
            position: relative;
            padding-top: 75%; /* Mantiene una relación de aspecto 4:3 para las imágenes (300/400 = 0.75) */
            height: 0;
            width: 100%;
            cursor: grab; /* Indica que se puede arrastrar */
        }
        .carousel-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }
        .carousel-item.active {
            opacity: 1;
            visibility: visible;
        }
        /* Estilos para la animación de fade de los detalles del producto */
        .product-details-fade {
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }
        .product-details-fade.active {
            opacity: 1;
            visibility: visible;
        }

        /* Animación para toda la página al cargar */
        body.fadeIn {
            opacity: 0;
            animation: fadeIn 0.8s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Animación para toda la página al salir (para enlaces) */
        body.fadeOut {
            animation: fadeOut 0.5s ease-in-out forwards;
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* --- Estilos de la Modal de Producto --- */
        .product-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden; /* Oculto por defecto */
            opacity: 0;
            transition: visibility 0.3s, opacity 0.3s ease-in-out;
        }

        .product-modal-overlay.open {
            visibility: visible;
            opacity: 1;
        }

        .product-modal-content {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            max-width: 90%; /* Ajuste para móvil */
            max-height: 90%; /* Ajuste para móvil */
            overflow-y: auto; /* Para scroll si el contenido es muy largo */
            transform: scale(0.9); /* Inicia un poco encogido */
            transition: transform 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .product-modal-overlay.open .product-modal-content {
            transform: scale(1); /* Se expande a tamaño normal */
        }

        .modal-close-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4a5568; /* gray-700 */
            transition: color 0.2s;
        }

        .modal-close-button:hover {
            color: #2d3748; /* gray-800 */
        }

        /* Responsive adjustments for modal content */
        @media (min-width: 640px) { /* sm breakpoint */
            .product-modal-content {
                flex-direction: row;
                max-width: 700px; /* Ancho máximo en desktop */
                padding: 2rem;
            }
        }

        /* Estilos para el menú desplegable */
        .menu-dropdown {
            display: none;
            position: absolute;
            background-color: #ffffff;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 0.5rem;
            overflow: hidden;
            right: 0; /* Align to the right of the parent */
            top: 100%; /* Position below the parent */
            margin-top: 0.5rem;
        }

        .menu-dropdown-open {
            display: block;
        }

        .menu-dropdown a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }

        .menu-dropdown a:hover {
            background-color: #f1f1f1;
            color: #8B5CF6; /* Tailwind purple-500 */
        }

        .dropdown-container {
            position: relative;
            display: inline-block;
        }

        /* Oculta la modal de categorías si existe, ya que ahora será un dropdown */
        .categories-modal-overlay {
            display: none !important;
        }

        /* Oculta el item de categorías en pantallas pequeñas */
        @media (max-width: 639px) { /* sm breakpoint */
            #categoriesMenuItem {
                display: none;
            }
        }

        /* Estilos del carrito de compras */
        .cart-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0.3s, opacity 0.3s ease-in-out;
        }

        .cart-modal-overlay.open {
            visibility: visible;
            opacity: 1;
        }

        .cart-modal-content {
            background-color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
        }

        .cart-modal-overlay.open .cart-modal-content {
            transform: scale(1);
        }

        .cart-close-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4a5568;
            transition: color 0.2s;
        }

        .cart-close-button:hover {
            color: #2d3748;
        }

        .cart-item {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .cart-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
    </style>
</head>
<body class="antialiased fadeIn">
    <nav class="w-full bg-white shadow-md p-4 flex justify-between items-center fixed top-0 z-50">
        <!-- Título "PROJECT MOM" (ya no es un enlace) -->
        <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-900 leading-tight tracking-tight">
            <span class="bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-pink-600 title-font">
                PROJECT MOM
            </span>
        </h1>

        <!-- Botón de menú hamburguesa para móviles -->
        <div class="sm:hidden flex items-center space-x-4">
            <button id="cartButtonMobile" class="relative text-gray-600 hover:text-purple-600 focus:outline-none">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                <span id="cartCountMobile" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
            </button>
            <button id="menuButton" class="text-gray-600 hover:text-purple-600 focus:outline-none">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>

        <!-- Menú de navegación principal (oculto en móvil por defecto, visible en sm y superior) -->
        <div id="navMenu" class="hidden sm:flex items-center space-x-6">
            <div class="dropdown-container">
                <a href="#" id="categoriesMenuItem" class="text-gray-700 hover:text-purple-600 font-semibold no-underline flex items-center">
                    Categorías
                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </a>
                <div id="categoriesDropdown" class="menu-dropdown">
                    <a href="level2.html" class="menu-item-link">Niños</a>
                    <a href="level3.html" class="menu-item-link">Caballeros</a>
                    <a href="level4.html" class="menu-item-link">Damas</a>
                    <a href="level5.html" class="menu-item-link">Accesorios</a>
                </div>
            </div>
            <a href="#" id="contactMenuItem" class="text-gray-700 hover:text-purple-600 font-semibold no-underline">Contacto</a>
            <button id="cartButtonDesktop" class="relative text-gray-700 hover:text-purple-600 font-semibold no-underline flex items-center">
                <svg class="w-6 h-6 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                Carrito
                <span id="cartCountDesktop" class="ml-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
            </button>
        </div>

        <!-- Menú desplegable para móviles (inicialmente oculto) -->
        <div id="menuDropdown" class="menu-dropdown absolute top-full right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50">
            <a href="#" id="categoriesMenuItemMobile" class="block px-4 py-2 text-gray-800 hover:bg-gray-100 flex justify-between items-center">
                Categorías
                <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </a>
            <div id="categoriesDropdownMobile" class="hidden pl-4">
                <a href="level2.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 menu-item-link">Niños</a>
                <a href="level3.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 menu-item-link">Caballeros</a>
                <a href="level4.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 menu-item-link">Damas</a>
                <a href="level5.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 menu-item-link">Accesorios</a>
            </div>
            <a href="#" id="contactMenuItemMobile" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Contacto</a>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8 max-w-7xl mt-16">
        <main class="text-gray-500">
            <section class="bg-white rounded-lg shadow-md p-3 sm:p-4 mb-6 relative overflow-hidden flex flex-col md:flex-row items-center md:items-start gap-3 md:gap-6">
                <div class="w-full md:w-1/2 flex flex-col items-center">
                    <div id="productCarousel" class="relative w-full max-w-xs sm:max-w-sm md:max-w-md overflow-hidden rounded-lg shadow-sm">
                        </div>

                    <div class="flex justify-center mt-4 space-x-4 md:flex">
                        <button id="prevBtn" class="p-2 rounded-full text-gray-600 hover:bg-gray-100 hover:text-purple-600 focus:outline-none transition duration-300 transform hover:scale-110">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <button id="nextBtn" class="p-2 rounded-full text-gray-600 hover:bg-gray-100 hover:text-purple-600 focus:outline-none transition duration-300 transform hover:scale-110">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>
                </div>

                <div id="productDetails" class="w-full md:w-1/2 text-center md:text-left product-details-fade
                            sm:relative sm:z-10 sm:bg-white/90 sm:px-6 sm:py-8 sm:-mt-20 sm:mx-auto sm:max-w-md sm:rounded-lg
                            md:mt-0 md:mx-0 md:max-w-none md:px-0 md:py-0 md:bg-transparent">
                    <h1 id="productName" class="text-xl sm:text-2xl font-extrabold text-gray-900 mb-1.5"></h1>
                    <p id="productPrice" class="text-lg font-bold text-purple-600 mb-2"></p>

                    <p id="productDescription" class="text-gray-700 leading-relaxed mb-3 text-xs"></p>

                    <!-- Se ha eliminado la sección de "Selecciona Estilo" -->

                    <div class="flex flex-col sm:flex-row gap-2 mt-6"> 
                        <a id="buyNowBtn" href="#" target="_blank" class="inline-block w-full sm:w-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2.5 px-4 rounded-full shadow-md transition duration-300 transform hover:scale-105 text-sm no-underline text-center">
                            Comprar Ahora
                        </a>
                        <button id="addToCartBtn" class="inline-block w-full sm:w-auto bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2.5 px-4 rounded-full shadow-md transition duration-300 transform hover:scale-105 text-sm">
                            Añadir al Carrito
                        </button>
                    </div>
                </div>
            </section>

            <section class="relative mt-12 mb-6 text-center mx-auto max-w-2xl px-4 py-8 rounded-lg shadow-md
                          bg-white">
                <p class="text-3xl sm:text-4xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-purple-600 to-pink-600">
                    ¡Tu estilo, tu historia! Encuentra la pieza perfecta que te define.
                </p>
            </section>

            <section class="mt-16 text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-8">Más para Ti</h2>
                <div id="moreForYouContainer" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 sm:gap-6">
                    <div id="mark1ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/f5f5f5/606060?text=Mark+1" alt="Mark 1" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 1</h3>
                    </div>
                    <div id="mark2ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/f0f0f0/707070?text=Producto+Extra+2" alt="Producto Extra +2" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 2</h3>
                    </div>
                    <div id="mark3ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/e5e5e5/808080?text=Producto+Extra+3" alt="Producto Extra +3" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 3</h3>
                    </div>
                    <div id="mark4ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/e0e0e0/909090?text=Producto+Extra+4" alt="Producto Extra +4" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 4</h3>
                    </div>
                    <div id="mark5ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/d5d5d5/a0a0a0?text=Producto+Extra+5" alt="Producto Extra +5" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 5</h3>
                    </div>
                    <div id="mark6ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://placehold.co/200x250/c0c0c0/303030?text=Mark+6" alt="Mark 6" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 6</h3>
                    </div>
                    <!-- Nuevo producto Mark 7 -->
                    <div id="mark7ProductLink" class="bg-white rounded-lg shadow-sm p-3 flex flex-col items-center cursor-pointer no-underline text-gray-800 hover:shadow-md transition">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQacFW2O_tGrpGS__29r83vCxTdhV8n79wT3A&s" alt="Mark 7" class="w-full h-auto rounded-md mb-2 object-cover">
                        <h3 class="text-sm font-semibold">Mark 7</h3>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-12 sm:mt-16 text-gray-500 text-xs sm:text-sm">
            <p>&copy; 2023 PROJECT MOM. Todos los derechos reservados.</p>
        </footer>
    </div>

    <!-- Modal de Producto -->
    <div id="productModalOverlay" class="product-modal-overlay">
        <div id="productModalContent" class="product-modal-content">
            <button id="closeModalBtn" class="modal-close-button">&times;</button>
            <div class="flex flex-col sm:flex-row items-center gap-4 sm:gap-6 w-full">
                <div class="sm:w-1/2 flex justify-center">
                    <img id="modalProductImage" src="" alt="Producto en Modal" class="w-full max-w-[250px] h-auto rounded-lg shadow-md object-cover">
                </div>
                <div class="sm:w-1/2 text-center sm:text-left">
                    <h2 id="modalProductName" class="text-2xl font-bold text-gray-900 mb-2"></h2>
                    <p id="modalProductPrice" class="text-xl font-bold text-purple-600 mb-3"></p>
                    <p id="modalProductDescription" class="text-gray-700 text-sm leading-relaxed mb-4"></p>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <a id="modalBuyNowBtn" href="#" target="_blank" class="inline-block w-full sm:w-auto bg-purple-600 hover:bg-purple-700 text-white font-bold py-2.5 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105 no-underline text-base text-center">
                            Comprar Ahora
                        </a>
                        <button id="modalAddToCartBtn" class="inline-block w-full sm:w-auto bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2.5 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105 text-base">
                            Añadir al Carrito
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal del Carrito de Compras -->
    <div id="cartModalOverlay" class="cart-modal-overlay">
        <div id="cartModalContent" class="cart-modal-content w-11/12 md:w-1/2 lg:w-1/3">
            <button id="closeCartModalBtn" class="cart-close-button">&times;</button>
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Tu Carrito de Compras</h2>
            <div id="cartItemsContainer" class="mb-4">
                <!-- Los artículos del carrito se añadirán aquí dinámicamente -->
            </div>
            <p class="text-lg font-bold text-gray-900 mb-4">Total: <span id="cartTotalPrice">$0.00</span></p>
            <button id="checkoutBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 transform hover:scale-105 text-lg">
                Proceder al Pago
            </button>
        </div>
    </div>

    <script type="module">
        document.addEventListener('DOMContentLoaded', function() {
            // Lógica del Carrusel y Detalles del Producto (variables globales)
            const productCarouselDiv = document.getElementById('productCarousel');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const productNameElem = document.getElementById('productName');
            const productPriceElem = document.getElementById('productPrice');
            const productDescriptionElem = document.getElementById('productDescription');
            // Eliminada la referencia a productThumbnailsDiv
            const productDetailsElem = document.getElementById('productDetails'); // Contenedor de los detalles para la animación
            const buyNowBtn = document.getElementById('buyNowBtn'); // Botón de Comprar
            const addToCartBtn = document.getElementById('addToCartBtn'); // Nuevo botón de añadir al carrito

            let currentProductIndex = 0; // Índice del producto actual

            // Datos de los productos (hardcodeados, ahora con 5 productos, cada uno con 3 estilos A, B, C)
            const products = [
                {
                    id: "prod1",
                    name: "Camiseta Mario Bross",
                    price: 35000, // Precio en pesos colombianos
                    // Descripción más larga para la camiseta de Mario Bross
                    description: "Sumérgete en el mundo de Mario Bross con esta camiseta de diseño único y creativo. Perfecta para los fans del clásico videojuego, esta camiseta combina comodidad y estilo para tu día a día. Fabricada con materiales de alta calidad que aseguran durabilidad y un ajuste suave. ¡Una pieza imprescindible para tu colección!",
                    images: [
                        "https://lh3.googleusercontent.com/d/1MhvYf5hIXJDEy4YlXxYqs5Z2lzHpMx6f=s1000", // Nueva imagen para P1 Estilo A
                        "https://placehold.co/400x300/f5f5f5/707070?text=P1+Estilo+B",
                        "https://placehold.co/400x300/ebebeb/808080?text=P1+Estilo+C"
                    ]
                },
                {
                    id: "prod2",
                    name: "Producto Principal 2",
                    price: 120.50,
                    description: "Descubre nuestro segundo producto, ideal para quienes buscan innovación y rendimiento. Su tecnología avanzada te sorprenderá.",
                    images: [
                        "https://placehold.co/400x300/e0e0e0/505050?text=P2+Estilo+A",
                        "https://placehold.co/400x300/e5e5e5/606060?text=P2+Estilo+B",
                        "https://placehold.co/400x300/d0d0d0/404040?text=P2+Estilo+C"
                    ]
                },
                {
                    id: "prod3",
                    name: "Producto Principal 3",
                    price: 75.00,
                    description: "El tercer producto es la opción perfecta para el día a día. Cómodo, duradero y con un estilo atemporal que nunca pasa de moda.",
                    images: [
                        "https://placehold.co/400x300/d0d0d0/404040?text=P3+Estilo+A",
                        "https://placehold.co/400x300/d5d5d5/505050?text=P3+Estilo+B",
                        "https://placehold.co/400x300/c0c0c0/303030?text=P3+Estilo+C"
                    ]
                },
                {
                    id: "prod4",
                    name: "Producto Principal 4",
                    price: 150.00,
                    description: "Un producto exclusivo con características únicas. Calidad premium garantizada. ¡Ideal para un regalo especial!",
                    images: [
                        "https://placehold.co/400x300/c0c0c0/303030?text=P4+Estilo+A",
                        "https://placehold.co/400x300/c5c5c5/404040?text=P4+Estilo+B",
                        "https://placehold.co/400x300/b0b0b0/202020?text=P4+Estilo+C"
                    ]
                },
                {
                    id: "prod5",
                    name: "Producto Principal 5",
                    price: 85.75,
                    description: "Diseñado para la comodidad y el estilo. Perfecto para cualquier ocasión y fácil de combinar. ¡Añádelo a tu colección!",
                    images: [
                        "https://placehold.co/400x300/b0b0b0/202020?text=P5+Estilo+A",
                        "https://placehold.co/400x300/b5b5b5/303030?text=P5+Estilo+B",
                        "https://placehold.co/400x300/a0a0a0/101010?text=P5+Estilo+C"
                    ]
                }
            ];

            // Función para actualizar el enlace de WhatsApp
            function updateWhatsAppLink(product, imageAlt) {
                let styleInfo = '';
                // Se ha eliminado la lógica de styleMatch ya que no hay selección de estilo
                let message = `¡Hola! Me gustaría comprar el "${product.name}".`;
                message += styleInfo;
                message += ` Precio: ${product.price.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})}.`; // Formato de moneda colombiana

                const whatsappNumber = '573024640777';
                const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
                return whatsappUrl;
            }

            // Función para mostrar la imagen activa en el carrusel principal
            function showCarouselImage(imageIndex) {
                const currentProductImages = productCarouselDiv.querySelectorAll('.carousel-item');
                currentProductImages.forEach((item, i) => {
                    item.classList.remove('active');
                    if (i === imageIndex) {
                        item.classList.add('active');
                    }
                });

                // Se ha eliminado la lógica de active-thumbnail
                const product = products[currentProductIndex];
                const currentImageAlt = productCarouselDiv.querySelector('.carousel-item.active img')?.alt || '';
                buyNowBtn.href = updateWhatsAppLink(product, currentImageAlt);
                addToCartBtn.dataset.productId = product.id;
                addToCartBtn.dataset.productStyleIndex = imageIndex;
            }

            // Función para renderizar el carrusel y los detalles del producto
            function renderProduct(index) {
                const product = products[index];

                const currentActiveImage = productCarouselDiv.querySelector('.carousel-item.active');
                const oldProductDetailsActive = productDetailsElem.classList.contains('active');

                if (currentActiveImage) {
                    currentActiveImage.classList.remove('active');
                }
                if (oldProductDetailsActive) {
                    productDetailsElem.classList.remove('active');
                }

                setTimeout(() => {
                    productCarouselDiv.innerHTML = '';
                    product.images.forEach((imgSrc, i) => {
                        const imgDiv = document.createElement('div');
                        imgDiv.classList.add('carousel-item');
                        const img = document.createElement('img');
                        img.src = imgSrc;
                        img.alt = `${product.name} - Estilo ${String.fromCharCode(65 + i)}`;
                        img.classList.add('w-full', 'h-full', 'object-cover');
                        imgDiv.appendChild(img);
                        productCarouselDiv.appendChild(imgDiv);
                    });

                    productNameElem.textContent = product.name;
                    productPriceElem.textContent = `${product.price.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})}`; // Formato de moneda colombiana
                    productDescriptionElem.textContent = product.description;

                    // Eliminada la lógica de productThumbnailsDiv
                    // productThumbnailsDiv.innerHTML = '';
                    // product.images.forEach((imgSrc, i) => {
                    //     const thumbnailDiv = document.createElement('div');
                    //     thumbnailDiv.classList.add('w-16', 'h-12', 'rounded-md', 'overflow-hidden', 'thumbnail-item', 'relative');
                    //     const thumbnailImg = document.createElement('img');
                    //     thumbnailImg.src = imgSrc;
                    //     thumbnailImg.alt = `${product.name} - Miniatura Estilo ${String.fromCharCode(65 + i)}`;
                    //     thumbnailImg.classList.add('w-full', 'h-full', 'object-cover');
                    //     thumbnailDiv.appendChild(thumbnailImg);
                    //     productThumbnailsDiv.appendChild(thumbnailDiv);

                    //     thumbnailDiv.addEventListener('click', () => {
                    //         showCarouselImage(i);
                    //     });
                    // });

                    if (product.images.length > 0) {
                        productCarouselDiv.querySelector('.carousel-item').classList.add('active');
                        // Eliminada la línea para añadir active-thumbnail a la miniatura
                    }
                    productDetailsElem.classList.add('active');

                    // Actualizar enlaces y botones del producto principal
                    const currentImageAlt = productCarouselDiv.querySelector('.carousel-item.active img')?.alt || '';
                    buyNowBtn.href = updateWhatsAppLink(product, currentImageAlt);
                    addToCartBtn.dataset.productId = product.id;
                    addToCartBtn.dataset.productStyleIndex = 0; // Por defecto, el primer estilo
                }, 400);
            }

            // Función para avanzar al siguiente producto
            function nextProduct() {
                currentProductIndex = (currentProductIndex + 1) % products.length;
                renderProduct(currentProductIndex);
            }

            // Función para retroceder al producto anterior
            function prevProduct() {
                currentProductIndex = (currentProductIndex - 1 + products.length) % products.length;
                renderProduct(currentProductIndex);
            }

            // Controladores de eventos para las flechas
            prevBtn.addEventListener('click', prevProduct);
            nextBtn.addEventListener('click', nextProduct);

            // DECLARACIONES DE ELEMENTOS DOM RELACIONADOS CON LAS MODALES Y EL MENÚ
            const productModalOverlay = document.getElementById('productModalOverlay');
            const closeModalBtn = document.getElementById('closeModalBtn');

            const modalProductImage = document.getElementById('modalProductImage');
            const modalProductName = document.getElementById('modalProductName');
            const modalProductPrice = document.getElementById('modalProductPrice');
            const modalProductDescription = document.getElementById('modalProductDescription');
            const modalBuyNowBtn = document.getElementById('modalBuyNowBtn');
            const modalAddToCartBtn = document.getElementById('modalAddToCartBtn'); // Nuevo botón de añadir al carrito de la modal

            // Elementos del menú
            const menuButton = document.getElementById('menuButton'); // Botón hamburguesa
            const menuDropdown = document.getElementById('menuDropdown'); // Menú desplegable móvil
            const categoriesMenuItem = document.getElementById('categoriesMenuItem'); // "Categorías" en desktop
            const categoriesDropdown = document.getElementById('categoriesDropdown'); // Dropdown de categorías en desktop
            const categoriesMenuItemMobile = document.getElementById('categoriesMenuItemMobile'); // "Categorías" en móvil
            const categoriesDropdownMobile = document.getElementById('categoriesDropdownMobile'); // Dropdown de categorías en móvil

            // Carrito de compras elementos
            const cartButtonDesktop = document.getElementById('cartButtonDesktop');
            const cartButtonMobile = document.getElementById('cartButtonMobile');
            const cartCountDesktop = document.getElementById('cartCountDesktop');
            const cartCountMobile = document.getElementById('cartCountMobile');
            const cartModalOverlay = document.getElementById('cartModalOverlay');
            const closeCartModalBtn = document.getElementById('closeCartModalBtn');
            const cartItemsContainer = document.getElementById('cartItemsContainer');
            const cartTotalPriceElem = document.getElementById('cartTotalPrice');
            const checkoutBtn = document.getElementById('checkoutBtn');

            let cart = JSON.parse(localStorage.getItem('cart')) || []; // Cargar carrito de localStorage

            // Referencias a los enlaces de categoría
            const ninosCategoryLink = document.querySelector('a[href="level2.html"]'); // Enlace actualizado
            const caballerosCategoryLink = document.querySelector('a[href="level3.html"]'); // Enlace actualizado
            const damasCategoryLink = document.querySelector('a[href="level4.html"]'); // Enlace actualizado
            const accesoriosCategoryLink = document.querySelector('a[href="level5.html"]'); // Enlace actualizado


            // REFERENCIAS A LOS PRODUCTOS DE "MÁS PARA TI"
            const mark1ProductLink = document.getElementById('mark1ProductLink');
            const mark2ProductLink = document.getElementById('mark2ProductLink');
            const mark3ProductLink = document.getElementById('mark3ProductLink');
            const mark4ProductLink = document.getElementById('mark4ProductLink');
            const mark5ProductLink = document.getElementById('mark5ProductLink');
            const mark6ProductLink = document.getElementById('mark6ProductLink');
            const mark7ProductLink = document.getElementById('mark7ProductLink');


            // Datos de los productos extra (modales)
            const extraProductDetails = {
                "mark1": {
                    id: "extra1",
                    name: "Mark 1",
                    price: 35.00,
                    description: "Nuestro icónico Mark 1. Diseño elegante y adaptable, perfecto para cualquier ocasión. Hecho con materiales duraderos que garantizan calidad y confort.",
                    image: "https://placehold.co/400x500/f5f5f5/606060?text=Mark+1"
                },
                "mark2": {
                    id: "extra2",
                    name: "Mark 2",
                    price: 55.00,
                    description: "Una evolución de nuestro producto Mark 1. Diseño mejorado, mayor durabilidad y características innovadoras que te encantarán. ¡Ideal para uso diario!",
                    image: "https://placehold.co/400x500/f0f0f0/707070?text=Mark+2+Completo"
                },
                "mark3": {
                    id: "extra3",
                    name: "Mark 3",
                    price: 75.00,
                    description: "El Mark 3 combina funcionalidad y estilo a la perfección. Es tu compañero ideal para aventuras diarias, ofreciendo una experiencia superior.",
                    image: "https://placehold.co/400x500/e5e5e5/808080?text=Mark+3+Completo"
                },
                "mark4": {
                    id: "extra4",
                    name: "Mark 4",
                    price: 150.00,
                    description: "Experimenta la exclusividad con el Mark 4. Una pieza de ingeniería y arte, diseñada para los más exigentes. Detalles premium y rendimiento sin igual.",
                    image: "https://placehold.co/400x500/e0e0e0/909090?text=Mark+4+Completo"
                },
                "mark5": {
                    id: "extra5",
                    name: "Mark 5",
                    price: 85.75,
                    description: "El Mark 5, tu aliado de estilo. Confort inigualable y un diseño que se adapta a tu ritmo de vida. Versátil y siempre a la moda.",
                    image: "https://placehold.co/400x500/d5d5d5/a0a0a0?text=Mark+5+Completo"
                },
                "mark6": {
                    id: "extra6",
                    name: "Mark 6",
                    price: 110.00,
                    description: "El nuevo Mark 6 llega con innovaciones que redefinirán tu experiencia. Potencia y elegancia en un solo producto, diseñado para el futuro.",
                    image: "https://placehold.co/400x500/c0c0c0/303030?text=Mark+6+Completo"
                },
                "mark7": {
                    id: "extra7",
                    name: "Mark 7",
                    price: 95.00,
                    description: "Un nuevo diseño innovador que combina lo clásico con lo moderno, ofreciendo una experiencia única y un estilo inigualable.",
                    image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQacFW2O_tGrpGS__29r83vCxTdhV8n79wT3A&s"
                }
            };

            // FUNCIONES DE MODAL DE PRODUCTO
            function openProductModal(productDetails) {
                modalProductImage.src = productDetails.image;
                modalProductImage.alt = productDetails.name;
                modalProductName.textContent = productDetails.name;
                modalProductPrice.textContent = `$${productDetails.price.toFixed(2)}`;
                modalProductDescription.textContent = productDetails.description;

                modalBuyNowBtn.href = updateWhatsAppLink(productDetails, productDetails.name); // Para el botón de la modal
                modalAddToCartBtn.dataset.productId = productDetails.id; // Asigna el ID para añadir al carrito
                modalAddToCartBtn.dataset.productName = productDetails.name;
                modalAddToCartBtn.dataset.productPrice = productDetails.price;
                modalAddToCartBtn.dataset.productImage = productDetails.image;

                productModalOverlay.classList.add('open');
                if (menuDropdown) menuDropdown.classList.remove('menu-dropdown-open'); // Cerrar menú móvil si está abierto
                if (cartModalOverlay) cartModalOverlay.classList.remove('open'); // Cerrar carrito si está abierto
            }

            function closeProductModal() {
                productModalOverlay.classList.remove('open');
            }

            // FUNCIONES DEL CARRITO
            function updateCartCount() {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCountDesktop.textContent = totalItems;
                cartCountMobile.textContent = totalItems;
            }

            function saveCart() {
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
            }

            function addToCart(product, quantity = 1) {
                const existingItemIndex = cart.findIndex(item => item.id === product.id && item.style === product.style);

                if (existingItemIndex > -1) {
                    cart[existingItemIndex].quantity += quantity;
                } else {
                    cart.push({ ...product, quantity });
                }
                saveCart();
                renderCartItems(); // Actualizar la vista del carrito si está abierta
            }

            function removeFromCart(productId, productStyle = null) {
                cart = cart.filter(item => !(item.id === productId && (productStyle === null || item.style === productStyle)));
                saveCart();
                renderCartItems();
            }

            function renderCartItems() {
                cartItemsContainer.innerHTML = '';
                let totalPrice = 0;

                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '<p class="text-gray-600">El carrito está vacío.</p>';
                    checkoutBtn.disabled = true;
                    checkoutBtn.classList.add('opacity-50', 'cursor-not-allowed');
                } else {
                    checkoutBtn.disabled = false;
                    checkoutBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    cart.forEach(item => {
                        const itemTotal = item.price * item.quantity;
                        totalPrice += itemTotal;

                        const cartItemDiv = document.createElement('div');
                        cartItemDiv.classList.add('cart-item');
                        cartItemDiv.innerHTML = `
                            <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md mr-4">
                            <div class="flex-grow">
                                <h3 class="text-md font-semibold text-gray-800">${item.name} ${item.style ? `- ${item.style}` : ''}</h3>
                                <p class="text-sm text-gray-600">Cantidad: ${item.quantity}</p>
                                <p class="text-sm font-bold text-purple-600">${item.price.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})} c/u</p>
                            </div>
                            <button class="remove-from-cart-btn bg-red-500 hover:bg-red-600 text-white p-1 rounded-full text-xs"
                                data-product-id="${item.id}"
                                data-product-style="${item.style || ''}">
                                &times;
                            </button>
                        `;
                        cartItemsContainer.appendChild(cartItemDiv);
                    });
                }

                cartTotalPriceElem.textContent = `${totalPrice.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})}`;

                // Añadir listeners para los botones de eliminar después de renderizar
                document.querySelectorAll('.remove-from-cart-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const productId = event.target.dataset.productId;
                        const productStyle = event.target.dataset.productStyle;
                        removeFromCart(productId, productStyle === '' ? null : productStyle);
                    });
                });
            }

            function openCartModal() {
                renderCartItems();
                cartModalOverlay.classList.add('open');
                if (menuDropdown) menuDropdown.classList.remove('menu-dropdown-open'); // Cerrar menú móvil si está abierto
                if (productModalOverlay) productModalOverlay.classList.remove('open'); // Cerrar modal de producto si está abierta
            }

            function closeCartModal() {
                cartModalOverlay.classList.remove('open');
            }

            function checkout() {
                if (cart.length === 0) {
                    // Aquí podrías mostrar un mensaje personalizado en lugar de un alert
                    console.log("El carrito está vacío. Añade productos antes de proceder al pago.");
                    return;
                }

                let whatsappMessage = "¡Hola! Me gustaría hacer un pedido con los siguientes artículos:\n\n";
                let totalOrderPrice = 0;

                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    whatsappMessage += `- ${item.name} ${item.style ? `(${item.style})` : ''} x ${item.quantity} = ${itemTotal.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})}\n`;
                    totalOrderPrice += itemTotal;
                });

                whatsappMessage += `\nTotal del pedido: ${totalOrderPrice.toLocaleString('es-CO', {style: 'currency', currency: 'COP', minimumFractionDigits: 0})}.`;

                const whatsappNumber = '573024640777';
                const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
                window.open(whatsappUrl, '_blank');
                cart = []; // Vaciar el carrito después de proceder al pago
                saveCart();
                closeCartModal();
            }


            // EVENT LISTENERS

            // Lógica para el botón de menú hamburguesa
            if (menuButton) {
                menuButton.addEventListener('click', function() {
                    menuDropdown.classList.toggle('menu-dropdown-open');
                    if (productModalOverlay) productModalOverlay.classList.remove('open');
                    if (cartModalOverlay) cartModalOverlay.classList.remove('open');
                });
            }

            // Lógica para abrir/cerrar el dropdown de categorías en desktop
            if (categoriesMenuItem) {
                categoriesMenuItem.addEventListener('click', function(event) {
                    event.preventDefault();
                    categoriesDropdown.classList.toggle('menu-dropdown-open');
                    if (menuDropdown) menuDropdown.classList.remove('menu-dropdown-open');
                    if (productModalOverlay) productModalOverlay.classList.remove('open');
                    if (cartModalOverlay) cartModalOverlay.classList.remove('open');
                });
            }

            // Lógica para abrir/cerrar el dropdown de categorías en móvil
            if (categoriesMenuItemMobile) {
                categoriesMenuItemMobile.addEventListener('click', function(event) {
                    event.preventDefault();
                    categoriesDropdownMobile.classList.toggle('hidden');
                });
            }

            // Lógica para los enlaces de categoría dentro de los dropdowns
            const categoryLinks = document.querySelectorAll('.menu-item-link');
            categoryLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    if (this.href && this.href !== window.location.href + '#') {
                        event.preventDefault();
                        document.body.classList.add('fadeOut');
                        const targetUrl = this.href;
                        setTimeout(() => {
                            window.location.href = targetUrl;
                        }, 500);
                    }
                });
            });

            // Asignar listeners a cada producto de "Más para Ti"
            if (mark1ProductLink) {
                mark1ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark1));
            }
            if (mark2ProductLink) {
                mark2ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark2));
            }
            if (mark3ProductLink) {
                mark3ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark3));
            }
            if (mark4ProductLink) {
                mark4ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark4));
            }
            if (mark5ProductLink) {
                mark5ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark5));
            }
            if (mark6ProductLink) {
                mark6ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark6));
            }
            if (mark7ProductLink) {
                mark7ProductLink.addEventListener('click', () => openProductModal(extraProductDetails.mark7));
            }

            // Listener para cerrar la modal de producto al hacer clic en la "X" o fuera de ella
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', closeProductModal);
            }
            if (productModalOverlay) {
                productModalOverlay.addEventListener('click', function(event) {
                    if (event.target === productModalOverlay) {
                        closeProductModal();
                    }
                });
            }

            // Listener para añadir al carrito (producto principal)
            addToCartBtn.addEventListener('click', () => {
                const product = products[currentProductIndex];
                const styleIndex = parseInt(addToCartBtn.dataset.productStyleIndex);
                // No es necesario obtener styleName aquí si no se va a usar
                const imageSrc = product.images[styleIndex];

                addToCart({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: imageSrc,
                    // Se establece un estilo predeterminado o se deja en null si no hay estilos
                    style: product.images.length > 1 ? `Estilo ${String.fromCharCode(65 + styleIndex)}` : null
                });
            });

            // Listener para añadir al carrito (modal de producto extra)
            modalAddToCartBtn.addEventListener('click', (event) => {
                const productId = event.target.dataset.productId;
                const productName = event.target.dataset.productName;
                const productPrice = parseFloat(event.target.dataset.productPrice);
                const productImage = event.target.dataset.productImage;

                addToCart({
                    id: productId,
                    name: productName,
                    price: productPrice,
                    image: productImage,
                    style: null // No hay estilo específico para productos extra
                });
                closeProductModal();
            });

            // Listener para abrir el carrito (desktop y mobile)
            cartButtonDesktop.addEventListener('click', openCartModal);
            cartButtonMobile.addEventListener('click', openCartModal);

            // Listener para cerrar el carrito
            closeCartModalBtn.addEventListener('click', closeCartModal);
            cartModalOverlay.addEventListener('click', function(event) {
                if (event.target === cartModalOverlay) {
                    closeCartModal();
                }
            });

            // Listener para el botón "Proceder al Pago"
            checkoutBtn.addEventListener('click', checkout);

            // Lógica para la animación de salida al hacer clic en enlaces de navegación
            const allNavLinks = document.querySelectorAll('nav a');
            allNavLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    // Evitar que los enlaces de menú (categorías/contacto) disparen el fadeOut inmediato
                    if (this.href && this.href !== window.location.href + '#' && this.href !== '#' &&
                        this.id !== 'categoriesMenuItem' &&
                        this.id !== 'categoriesMenuItemMobile' &&
                        !this.classList.contains('menu-item-link')) {
                        event.preventDefault();
                        document.body.classList.add('fadeOut');
                        const targetUrl = this.href;
                        setTimeout(() => {
                            window.location.href = targetUrl;
                        }, 500);
                    }
                });
            });

            // Renderizar el primer producto al cargar la página
            renderProduct(currentProductIndex);
            updateCartCount(); // Actualizar el contador del carrito al cargar la página
        });
    </script>
</body>
</html>
